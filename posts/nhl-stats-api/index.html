<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Modernizing Public Hockey Analytics" /><meta property="og:locale" content="en" /><meta name="description" content="Do you like hockey? Do you like data? Then you might like reading more about this project. Spoiler: it involves hockey, analytics, and a whole bunch of data engineering and data-science…" /><meta property="og:description" content="Do you like hockey? Do you like data? Then you might like reading more about this project. Spoiler: it involves hockey, analytics, and a whole bunch of data engineering and data-science…" /><link rel="canonical" href="https://bicks-bapa-roob.github.io/posts/nhl-stats-api/" /><meta property="og:url" content="https://bicks-bapa-roob.github.io/posts/nhl-stats-api/" /><meta property="og:site_name" content="Bicks-Bapa-Roob" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-11T12:00:00-07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Modernizing Public Hockey Analytics" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-11T19:30:00-07:00","datePublished":"2022-05-11T12:00:00-07:00","description":"Do you like hockey? Do you like data? Then you might like reading more about this project. Spoiler: it involves hockey, analytics, and a whole bunch of data engineering and data-science…","headline":"Modernizing Public Hockey Analytics","mainEntityOfPage":{"@type":"WebPage","@id":"https://bicks-bapa-roob.github.io/posts/nhl-stats-api/"},"url":"https://bicks-bapa-roob.github.io/posts/nhl-stats-api/"}</script><title>Modernizing Public Hockey Analytics | Bicks-Bapa-Roob</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Bicks-Bapa-Roob"><meta name="application-name" content="Bicks-Bapa-Roob"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Bicks-Bapa-Roob</a></div><div class="site-subtitle font-italic">Data, learning and good vibes</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>DOCUMENTATION</span> </a><li class="nav-item"> <a href="/projects/" class="nav-link"> <i class="fa-fw fas fa-portfolio ml-xl-3 mr-xl-3 unloaded"></i> <span>PORTFOLIO</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/bicks-bapa-roob" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Modernizing Public Hockey Analytics</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 214'%3E%3C/svg%3E" data-src="/assets/posts/hockey-analytics-meme.png" class="preview-img bg" alt="hockey analytics meme" width="320" height="214" data-proofer-ignore><h1 data-toc-skip>Modernizing Public Hockey Analytics</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/bicks-bapa-roob">Bicks-Bapa-Roob</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1652295600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-11 </em> </span> <span> Updated <em class="timeago" data-ts="1652322600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-11 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="476 words"> <em>2 min</em> read</span></div></div></div><div class="post-content"><p>Do you like hockey? Do you like data? Then you might like reading more about this project. Spoiler: it involves hockey, analytics, and a whole bunch of data engineering and data-science…</p><blockquote><p>A modern application of data-engineering and data-science on public Hockey (NHL) data for the purposes of learning &amp; development</p></blockquote><h2 id="table-of-contents"><span class="mr-2">Table of contents</span><a href="#table-of-contents" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><a href="#introduction">Introduction</a><li><a href="#architecture">Architecture</a><li><a href="#setup">Setup</a><li><a href="#resources">Resources</a><li><a href="#developer-contact">Developer contact</a></ul><h2 id="introduction"><span class="mr-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>The motivation behind this project was simple: make public hockey data available using modern technologies for the purposes of data-science &amp; data-visualization. We wanted to be able to answer questions like…</p><ul><li>Which players are most likely to have a breakout season next year?<li>Which draft prospects are most likely to succeed in the NHL?<li>How many goals should we expect from elite players like Connor McDavid or Auston Matthews next season?<li>Where on the ice are individual players most efficient with their shooting?</ul><h2 id="architecture"><span class="mr-2">Architecture</span><a href="#architecture" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>In order to get to this state of-course, a lot of data-engineering was necessary. Below is a visual representation of the project architecture.</p><p><img data-src="/assets/posts/hockey-project-architecture.png" alt="Miro project architecture" data-proofer-ignore></p><h3 id="data-extraction"><span class="mr-2">Data extraction</span><a href="#data-extraction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Currently, we only have a single source of data: the NHL Stats API. The Github repo that we built to extract the data is called <code class="language-plaintext highlighter-rouge">tap-nhl</code>. It is a Singer tap for the NHL Stats API.</p><p>Built with the <a href="https://sdk.meltano.com">Meltano Tap SDK</a> for Singer Taps.</p><p>Below is a flow diagram explaining how it works:</p><pre><code class="language-mermaid">flowchart TD
Root[NHL Stats API] --&gt;|Year| Seasons[Seasons]
Root[NHL Stats API] --&gt; Conferences[Conferences]
Root[NHL Stats API] --&gt; Divisions[Divisions]
Root[NHL Stats API] --&gt;|Year| Draft[Draft]
Seasons[Seasons] --&gt;|Season| Schedule[Schedule]
Seasons[Seasons] --&gt; |Season| Teams[Teams]
Schedule[Schedule] --&gt;|Game PK| Game[Game]
Game[Game] --&gt;|Game PK| Plays[Live Feed Plays]
Game[Game] --&gt;|Game PK| Linescore[Live Feed Linescore]
Game[Game] --&gt;|Game PK| Boxscore[Live Feed Boxscore]
Teams[Teams] --&gt; |Roster| Player[Players]
Draft[Draft] --&gt;|Prospect ID| Prospects[Prospects]
</code></pre><p>Resources</p><ul><li>Repo: <a href="https://github.com/bicks-bapa-roob/dbt-nhl-breakouts">tap-nhl</a></ul><h3 id="data-transformation--loading"><span class="mr-2">Data transformation &amp; loading</span><a href="#data-transformation--loading" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>All of this work is contained within a Github repo called <code class="language-plaintext highlighter-rouge">dbt-nhl-breakouts</code> and uses dbt to model our raw data. It contains the source code used to transform raw nhl data from the NHL Stats API into analysis-ready models.</p><p>In other words, this is where the SQL magic happens using dbt. Ultimately, this work converts confusing raw data into:</p><ul><li>Data analyst/scientist friendly datasets all within one data warehouse (BigQuery)<li>Well-documented tables, field definitions, and queries<li>Reliable data that is tested and validated before ever making it into production</ul><p>Resources</p><ul><li>Repo: <a href="https://github.com/bicks-bapa-roob/dbt-nhl-breakouts">dbt-nhl-breakouts</a><li>Documentation: <a href="https://bicks-bapa-roob.github.io/dbt-nhl-breakouts/#!/overview">dbt generated documentation</a></ul><h3 id="data-science"><span class="mr-2">Data science</span><a href="#data-science" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Consider this section separate from the rest. Each question that we decide to answer of our newly modeled data will live in this bucket. For example, one of the projects that spawned from this was the <a href="https://github.com/bicks-bapa-roob/nhl-breakouts">nhl-breakouts project</a></p><h2 id="setup"><span class="mr-2">Setup</span><a href="#setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>TBD..</p><h2 id="resources"><span class="mr-2">Resources</span><a href="#resources" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><ul><li>Learn more about dbt <a href="https://docs.getdbt.com/docs/introduction">in the docs</a><li>Check out <a href="https://discourse.getdbt.com/">Discourse</a> for commonly asked questions and answers<li>Join the <a href="https://community.getdbt.com/">chat</a> on Slack for live discussions and support<li>Find <a href="https://events.getdbt.com">dbt events</a> near you<li>Check out <a href="https://blog.getdbt.com/">the blog</a> for the latest news on dbt’s development and best practices</ul><h2 id="developer-contact"><span class="mr-2">Developer contact</span><a href="#developer-contact" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><ul><li><a href="https://github.com/gavh3">@gavh3</a><li><a href="https://github.com/dmf95">@dmf95</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/projects/'>Projects</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/data-science/" class="post-tag no-text-decoration" >data-science</a> <a href="/tags/data-engineering/" class="post-tag no-text-decoration" >data-engineering</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/tags/singer/" class="post-tag no-text-decoration" >singer</a> <a href="/tags/meltano/" class="post-tag no-text-decoration" >meltano</a> <a href="/tags/bigquery/" class="post-tag no-text-decoration" >bigquery</a> <a href="/tags/dbt/" class="post-tag no-text-decoration" >dbt</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Modernizing Public Hockey Analytics - Bicks-Bapa-Roob&amp;url=https://bicks-bapa-roob.github.io/posts/nhl-stats-api/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Modernizing Public Hockey Analytics - Bicks-Bapa-Roob&amp;u=https://bicks-bapa-roob.github.io/posts/nhl-stats-api/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://bicks-bapa-roob.github.io/posts/nhl-stats-api/&amp;text=Modernizing Public Hockey Analytics - Bicks-Bapa-Roob" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/bicks-bapa-roob/">An origin story - Bicks-Bapa-Roob</a><li><a href="/posts/nhl-stats-api/">Modernizing Public Hockey Analytics</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/bigquery/">bigquery</a> <a class="post-tag" href="/tags/data-engineering/">data-engineering</a> <a class="post-tag" href="/tags/data-science/">data-science</a> <a class="post-tag" href="/tags/dbt/">dbt</a> <a class="post-tag" href="/tags/general/">general</a> <a class="post-tag" href="/tags/meltano/">meltano</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/singer/">singer</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/bicks-bapa-roob/"><div class="card-body"> <em class="timeago small" data-ts="1641063600" > 2022-01-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>An origin story - Bicks-Bapa-Roob</h3><div class="text-muted small"><p> By now you might be wondering, what the heck is “Bicks-bapa-roob”? It all started during the summer of 2021. One beautiful summer morning, our founding members decided to hike Panorama Ridge altog...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/bicks-bapa-roob/" class="btn btn-outline-primary" prompt="Older"><p>An origin story - Bicks-Bapa-Roob</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/bicks-bapa-roob">Bicks-Bapa-Roob</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/bigquery/">bigquery</a> <a class="post-tag" href="/tags/data-engineering/">data-engineering</a> <a class="post-tag" href="/tags/data-science/">data-science</a> <a class="post-tag" href="/tags/dbt/">dbt</a> <a class="post-tag" href="/tags/general/">general</a> <a class="post-tag" href="/tags/meltano/">meltano</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/singer/">singer</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
